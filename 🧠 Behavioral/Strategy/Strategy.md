# Паттерн проектирования: Стратегия (Strategy)

**Стратегия** — это поведенческий паттерн проектирования, который определяет семейство схожих алгоритмов и помещает каждый из них в собственный класс. Это позволяет взаимозаменять эти алгоритмы прямо во время выполнения программы (**Runtime**).



[Image of Strategy design pattern diagram]


---

## Проблема
Когда у вас есть много вариантов одного и того же действия (например, разные способы расчета скидки), использование `if-else` или `switch` раздувает код. Если завтра появится новая скидка «Пенсионная», вам придется переписывать основной класс заказа, что нарушает принцип открытости/закрытости.

## Как это работает (на примере расчета чека)

### 1. Интерфейс стратегии (PricingStrategy)
Это общий контракт. Любой алгоритм расчета цены должен уметь принимать базовую стоимость и возвращать итоговую.
```java
interface PricingStrategy {
    double calculatePrice(double rawPrice);
}
```

### 2. Конкретные стратегии
Каждый класс реализует свою формулу расчета:
* `RegularPriceStrategy`: Цена без изменений.
* `StudentDiscountStrategy`: Минус 15%.
* `VipDiscountStrategy`: Минус 50%.
* `HappyHourStrategy`: Вычитает фиксированную сумму.

### 3. Контекст (Bill)
Класс чека не знает, какая формула применяется. Он просто хранит ссылку на `PricingStrategy` и вызывает её метод. Благодаря сеттеру `setStrategy`, мы можем менять логику расчета «на лету», не создавая новый чек.

```java
class Bill {
    private PricingStrategy strategy;

    public void setStrategy(PricingStrategy strategy) {
        this.strategy = strategy; // Меняем алгоритм "на лету"
    }

    public void printBill(double rawPrice) {
        double finalPrice = strategy.calculatePrice(rawPrice);
        System.out.println("Итого: " + finalPrice);
    }
}
```

---

## Преимущества

1.  **Замена алгоритмов в рантайме:** Можно переключить скидку прямо в процессе оформления заказа.
2.  **Изоляция:** Код расчета отделен от кода самого чека.
3.  **Уход от ветвления:** Вы избавляетесь от громоздких `if (clientType == STUDENT)`.
4.  **Расширяемость:** Новую скидку можно добавить, просто создав новый класс, не меняя существующий код.

---

## Использование (Client)
```java
Bill bill = new Bill(new RegularPriceStrategy());
bill.printBill(1000); // Обычная цена

bill.setStrategy(new StudentDiscountStrategy());
bill.printBill(1000); // Теперь этот же чек посчитает со скидкой
```

> **Важное отличие:** В отличие от паттерна **Состояние**, стратегии обычно не знают друг о друге. Клиент сам решает, какую "флешку" (алгоритм) вставить в контекст в данный момент.